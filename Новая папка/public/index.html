<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SalonHelper - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∞–ª–æ–Ω–æ–º</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
            opacity: 0;
            transform: translateY(20px);
        }
        
        .header {
            background: #2d3748;
            color: white;
            padding: 30px 20px;
            text-align: center;
            position: relative;
        }
        
        .header h1 {
            font-size: 24px;
            margin-bottom: 5px;
        }
        
        .user-info {
            position: absolute;
            top: 10px;
            right: 15px;
            background: rgba(255,255,255,0.2);
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
        }
        
        .content {
            padding: 20px;
            min-height: 400px;
        }
        
        .section {
            display: none;
        }
        
        .section.active {
            display: block;
        }
        
        .back-button {
            background: none;
            border: none;
            color: #4a5568;
            font-size: 14px;
            margin-bottom: 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #4a5568;
        }
        
        .form-group input, .form-group textarea, .form-group select {
            width: 100%;
            padding: 12px;
            border: 1px solid #e2e8f0;
            border-radius: 10px;
            font-size: 16px;
        }
        
        .btn-primary {
            width: 100%;
            background: #667eea;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            margin-bottom: 10px;
        }
        
        .btn-success {
            background: #38a169;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
        }
        
        .btn-danger {
            background: #e53e3e;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
        }
        
        .services-list, .clients-list, .appointments-list {
            margin-top: 20px;
        }
        
        .service-item, .client-item, .appointment-item {
            background: #f7fafc;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border: 1px solid #e2e8f0;
            position: relative;
        }
        
        .item-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .service-name, .client-name {
            font-weight: bold;
            color: #2d3748;
            font-size: 16px;
        }
        
        .service-price {
            color: #667eea;
            font-weight: bold;
        }
        
        .service-duration, .client-phone {
            color: #718096;
            font-size: 14px;
        }
        
        .appointment-details {
            font-size: 14px;
            color: #4a5568;
            margin-top: 5px;
        }
        
        .appointment-time {
            font-weight: bold;
            color: #2d3748;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #718096;
        }
        
        .menu {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .menu-item {
            background: #edf2f7;
            padding: 15px;
            border-radius: 12px;
            border: none;
            font-size: 16px;
            cursor: pointer;
            text-align: left;
            transition: all 0.3s ease;
        }
        
        .menu-item:hover {
            background: #e2e8f0;
            transform: translateY(-2px);
        }
        
        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: #f7fafc;
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid #e2e8f0;
        }
        
        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #4a5568;
        }
        
        .stat-label {
            font-size: 12px;
            color: #718096;
            margin-top: 5px;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .tab {
            padding: 10px 15px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 14px;
            color: #718096;
            border-bottom: 2px solid transparent;
        }
        
        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }
        
        .calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            margin-bottom: 20px;
        }
        
        .calendar-day {
            padding: 10px;
            text-align: center;
            border-radius: 8px;
            background: #f7fafc;
            cursor: pointer;
        }
        
        .calendar-day.selected {
            background: #667eea;
            color: white;
        }
        
        .time-slots {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .time-slot {
            padding: 10px;
            text-align: center;
            background: #edf2f7;
            border-radius: 8px;
            cursor: pointer;
            border: none;
        }
        
        .time-slot.selected {
            background: #667eea;
            color: white;
        }
        
        .time-slot.booked {
            background: #e53e3e;
            color: white;
            cursor: not-allowed;
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            color: #718096;
            font-size: 12px;
            border-top: 1px solid #e2e8f0;
        }
        
        .status-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: bold;
        }
        
        .status-confirmed {
            background: #c6f6d5;
            color: #22543d;
        }
        
        .status-pending {
            background: #fed7d7;
            color: #742a2a;
        }
        
        .status-completed {
            background: #bee3f8;
            color: #1a365d;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 id="header-title">SalonHelper</h1>
            <p>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∞–ª–æ–Ω–æ–º</p>
            <div class="user-info" id="user-info"></div>
        </div>
        
        <div class="content">
            <!-- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é -->
            <div id="main-menu" class="section active">
                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-number" id="services-count">0</div>
                        <div class="stat-label">—É—Å–ª—É–≥</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="clients-count">0</div>
                        <div class="stat-label">–∫–ª–∏–µ–Ω—Ç–æ–≤</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="appointments-today">0</div>
                        <div class="stat-label">–∑–∞–ø–∏—Å–µ–π —Å–µ–≥–æ–¥–Ω—è</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="revenue-today">0</div>
                        <div class="stat-label">–¥–æ—Ö–æ–¥ —Å–µ–≥–æ–¥–Ω—è</div>
                    </div>
                </div>
                
                <div class="menu">
                    <button class="menu-item" onclick="showSection('services')">üíÖ –£—Å–ª—É–≥–∏ –∏ —Ü–µ–Ω—ã</button>
                    <button class="menu-item" onclick="showSection('clients')">üë• –ë–∞–∑–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤</button>
                    <button class="menu-item" onclick="showSection('appointments')">üìÖ –ó–∞–ø–∏—Å–∏ –∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—å</button>
                    <button class="menu-item" onclick="showSection('reports')">üìä –û—Ç—á–µ—Ç—ã –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞</button>
                    <button class="menu-item" onclick="showSection('settings')">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                </div>
            </div>
            
            <!-- –†–∞–∑–¥–µ–ª —É—Å–ª—É–≥ -->
            <div id="services" class="section">
                <button class="back-button" onclick="showSection('main-menu')">‚Üê –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é</button>
                <h2 style="margin-bottom: 20px;">üíÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∞–º–∏</h2>
                
                <form id="service-form">
                    <div class="form-group">
                        <label for="service-name">–ù–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏ *</label>
                        <input type="text" id="service-name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ú–∞–Ω–∏–∫—é—Ä" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="service-price">–¶–µ–Ω–∞ (—Ä—É–±) *</label>
                        <input type="number" id="service-price" placeholder="1000" min="0" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="service-duration">–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–º–∏–Ω) *</label>
                        <input type="number" id="service-duration" placeholder="60" min="5" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="service-category">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                        <select id="service-category">
                            <option value="nails">–ù–æ–≥—Ç–µ–≤–æ–π —Å–µ—Ä–≤–∏—Å</option>
                            <option value="hair">–ü–∞—Ä–∏–∫–º–∞—Ö–µ—Ä—Å–∫–∏–µ —É—Å–ª—É–≥–∏</option>
                            <option value="cosmetology">–ö–æ—Å–º–µ—Ç–æ–ª–æ–≥–∏—è</option>
                            <option value="massage">–ú–∞—Å—Å–∞–∂</option>
                            <option value="other">–î—Ä—É–≥–æ–µ</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="service-description">–û–ø–∏—Å–∞–Ω–∏–µ —É—Å–ª—É–≥–∏</label>
                        <textarea id="service-description" placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —É—Å–ª—É–≥–∏..."></textarea>
                    </div>
                    
                    <button type="submit" class="btn-primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —É—Å–ª—É–≥—É</button>
                </form>
                
                <div class="services-list" id="services-list">
                    <div class="empty-state">
                        –£—Å–ª—É–≥ –ø–æ–∫–∞ –Ω–µ—Ç. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é —É—Å–ª—É–≥—É!
                    </div>
                </div>
            </div>
            
            <!-- –†–∞–∑–¥–µ–ª –∫–ª–∏–µ–Ω—Ç–æ–≤ -->
            <div id="clients" class="section">
                <button class="back-button" onclick="showSection('main-menu')">‚Üê –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é</button>
                <h2 style="margin-bottom: 20px;">üë• –ë–∞–∑–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤</h2>
                
                <form id="client-form">
                    <div class="form-group">
                        <label for="client-name">–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞ *</label>
                        <input type="text" id="client-name" placeholder="–ò–º—è –∏ —Ñ–∞–º–∏–ª–∏—è" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="client-phone">–¢–µ–ª–µ—Ñ–æ–Ω *</label>
                        <input type="tel" id="client-phone" placeholder="+7 XXX XXX XX XX" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="client-email">Email</label>
                        <input type="email" id="client-email" placeholder="email@example.com">
                    </div>
                    
                    <div class="form-group">
                        <label for="client-notes">–ó–∞–º–µ—Ç–∫–∏</label>
                        <textarea id="client-notes" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∏–µ–Ω—Ç–µ..."></textarea>
                    </div>
                    
                    <button type="submit" class="btn-primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞</button>
                </form>
                
                <div class="clients-list" id="clients-list">
                    <div class="empty-state">
                        –ö–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞!
                    </div>
                </div>
            </div>
            
            <!-- –†–∞–∑–¥–µ–ª –∑–∞–ø–∏—Å–µ–π -->
            <div id="appointments" class="section">
                <button class="back-button" onclick="showSection('main-menu')">‚Üê –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é</button>
                <h2 style="margin-bottom: 20px;">üìÖ –ó–∞–ø–∏—Å–∏ –∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—å</h2>
                
                <div class="tabs">
                    <button class="tab active" onclick="showAppointmentTab('new')">–ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å</button>
                    <button class="tab" onclick="showAppointmentTab('calendar')">–ö–∞–ª–µ–Ω–¥–∞—Ä—å</button>
                    <button class="tab" onclick="showAppointmentTab('list')">–í—Å–µ –∑–∞–ø–∏—Å–∏</button>
                </div>
                
                <!-- –í–∫–ª–∞–¥–∫–∞ –Ω–æ–≤–æ–π –∑–∞–ø–∏—Å–∏ -->
                <div id="appointment-new" class="appointment-tab">
                    <form id="appointment-form">
                        <div class="form-group">
                            <label for="appointment-client">–ö–ª–∏–µ–Ω—Ç *</label>
                            <select id="appointment-client" required>
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∏–µ–Ω—Ç–∞</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="appointment-service">–£—Å–ª—É–≥–∞ *</label>
                            <select id="appointment-service" required>
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="appointment-date">–î–∞—Ç–∞ *</label>
                            <input type="date" id="appointment-date" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="appointment-time">–í—Ä–µ–º—è *</label>
                            <input type="time" id="appointment-time" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="appointment-notes">–ü—Ä–∏–º–µ—á–∞–Ω–∏—è</label>
                            <textarea id="appointment-notes" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è..."></textarea>
                        </div>
                        
                        <button type="submit" class="btn-primary">üìÖ –°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å</button>
                    </form>
                </div>
                
                <!-- –í–∫–ª–∞–¥–∫–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è -->
                <div id="appointment-calendar" class="appointment-tab" style="display: none;">
                    <div class="calendar" id="calendar-days"></div>
                    <div class="time-slots" id="time-slots"></div>
                </div>
                
                <!-- –í–∫–ª–∞–¥–∫–∞ —Å–ø–∏—Å–∫–∞ –∑–∞–ø–∏—Å–µ–π -->
                <div id="appointment-list" class="appointment-tab" style="display: none;">
                    <div class="appointments-list" id="appointments-list">
                        <div class="empty-state">
                            –ó–∞–ø–∏—Å–µ–π –ø–æ–∫–∞ –Ω–µ—Ç
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –†–∞–∑–¥–µ–ª –æ—Ç—á–µ—Ç–æ–≤ -->
            <div id="reports" class="section">
                <button class="back-button" onclick="showSection('main-menu')">‚Üê –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é</button>
                <h2 style="margin-bottom: 20px;">üìä –û—Ç—á–µ—Ç—ã –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞</h2>
                
                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-number" id="report-total-revenue">0</div>
                        <div class="stat-label">–æ–±—â–∏–π –¥–æ—Ö–æ–¥</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="report-total-appointments">0</div>
                        <div class="stat-label">–≤—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="report-avg-receipt">0</div>
                        <div class="stat-label">—Å—Ä–µ–¥–Ω–∏–π —á–µ–∫</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="report-popular-service">-</div>
                        <div class="stat-label">–ø–æ–ø—É–ª—è—Ä–Ω–∞—è —É—Å–ª—É–≥–∞</div>
                    </div>
                </div>
                
                <div style="margin-top: 20px;">
                    <button class="btn-primary" onclick="generateReport()">üìà –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á–µ—Ç</button>
                    <button class="btn-primary" style="background: #38a169;" onclick="exportData()">üì§ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</button>
                </div>
            </div>
            
            <!-- –†–∞–∑–¥–µ–ª –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
            <div id="settings" class="section">
                <button class="back-button" onclick="showSection('main-menu')">‚Üê –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é</button>
                <h2 style="margin-bottom: 20px;">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
                
                <div class="form-group">
                    <label for="business-name">–ù–∞–∑–≤–∞–Ω–∏–µ –±–∏–∑–Ω–µ—Å–∞</label>
                    <input type="text" id="business-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ —Å–∞–ª–æ–Ω–∞">
                </div>
                
                <div class="form-group">
                    <label for="business-phone">–¢–µ–ª–µ—Ñ–æ–Ω —Å–∞–ª–æ–Ω–∞</label>
                    <input type="tel" id="business-phone" placeholder="+7 XXX XXX XX XX">
                </div>
                
                <div class="form-group">
                    <label for="work-hours">–ß–∞—Å—ã —Ä–∞–±–æ—Ç—ã</label>
                    <input type="text" id="work-hours" placeholder="9:00 - 21:00">
                </div>
                
                <div class="form-group">
                    <label for="time-interval">–ò–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –∑–∞–ø–∏—Å—è–º–∏ (–º–∏–Ω)</label>
                    <input type="number" id="time-interval" value="30" min="15">
                </div>
                
                <button class="btn-primary" onclick="saveSettings()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                
                <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #e2e8f0;">
                    <h3 style="margin-bottom: 15px;">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏</h3>
                    <button class="btn-primary" style="background: #ed8936;" onclick="loadSampleData()">üé≤ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ</button>
                    <button class="btn-primary" style="background: #e53e3e; margin-top: 10px;" onclick="clearAllData()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ</button>
                </div>
            </div>
        </div>
        
        <div class="footer">
            SalonHelper ¬© 2024 | –í–∞—à –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫
        </div>
    </div>

    <script>
        // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================
        console.log('SalonHelper –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...');
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        let tg;
        try {
            tg = window.Telegram.WebApp;
            tg.expand();
            tg.enableClosingConfirmation();
            console.log('Telegram Web App –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
        } catch (error) {
            console.log('Telegram Web App –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, —Ä–∞–±–æ—Ç–∞–µ–º –≤ –±—Ä–∞—É–∑–µ—Ä–µ');
            tg = {
                showPopup: function(params) {
                    alert(params.title + ': ' + params.message);
                },
                expand: function() {},
                enableClosingConfirmation: function() {}
            };
        }
        
        // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Telegram
        const user = tg.initDataUnsafe?.user;
        const userId = user?.id || 1;
        
        // ==================== –°–ò–°–¢–ï–ú–ê –•–†–ê–ù–ï–ù–ò–Ø –î–ê–ù–ù–´–• ====================
        function getData(key, defaultValue = []) {
            try {
                return JSON.parse(localStorage.getItem(key)) || defaultValue;
            } catch (e) {
                return defaultValue;
            }
        }
        
        function saveData(key, data) {
            localStorage.setItem(key, JSON.stringify(data));
        }
        
        // –û—Å–Ω–æ–≤–Ω—ã–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö
        const dataStores = {
            services: 'salon-services',
            clients: 'salon-clients',
            appointments: 'salon-appointments',
            settings: 'salon-settings'
        };
        
        // ==================== –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================
        
        // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');
            updateDashboard();
        }
        
        // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≤–∫–ª–∞–¥–∫–∞–º –∑–∞–ø–∏—Å–µ–π
        function showAppointmentTab(tabName) {
            document.querySelectorAll('.appointment-tab').forEach(tab => {
                tab.style.display = 'none';
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById('appointment-' + tabName).style.display = 'block';
            event.target.classList.add('active');
            
            if (tabName === 'new') {
                loadAppointmentForm();
            } else if (tabName === 'calendar') {
                loadCalendar();
            } else if (tabName === 'list') {
                loadAppointmentsList();
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥–ª–∞–≤–Ω–æ–π –ø–∞–Ω–µ–ª–∏
        function updateDashboard() {
            const services = getData(dataStores.services);
            const clients = getData(dataStores.clients);
            const appointments = getData(dataStores.appointments);
            const settings = getData(dataStores.settings, {});
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            document.getElementById('services-count').textContent = services.length;
            document.getElementById('clients-count').textContent = clients.length;
            
            // –ó–∞–ø–∏—Å–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
            const today = new Date().toISOString().split('T')[0];
            const todayAppointments = appointments.filter(apt => apt.date === today);
            document.getElementById('appointments-today').textContent = todayAppointments.length;
            
            // –î–æ—Ö–æ–¥ –∑–∞ —Å–µ–≥–æ–¥–Ω—è
            const todayRevenue = todayAppointments.reduce((sum, apt) => {
                const service = services.find(s => s.id === apt.serviceId);
                return sum + (service ? service.price : 0);
            }, 0);
            document.getElementById('revenue-today').textContent = todayRevenue;
            
            // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
            if (user) {
                const userName = user.first_name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
                document.getElementById('header-title').innerHTML = 
                    `SalonHelper <small style="display:block; font-size:14px; margin-top:5px;">${settings.businessName || '–í–∞—à —Å–∞–ª–æ–Ω'}</small>`;
                document.getElementById('user-info').textContent = userName;
            }
        }
        
        // ==================== –†–ê–ó–î–ï–õ –£–°–õ–£–ì ====================
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ä–º—ã —É—Å–ª—É–≥
        function loadServicesForm() {
            // –§–æ—Ä–º–∞ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –≤ HTML
        }
        
        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Å–ø–∏—Å–∫–∞ —É—Å–ª—É–≥
        function renderServices() {
            const services = getData(dataStores.services);
            const servicesList = document.getElementById('services-list');
            
            if (services.length === 0) {
                servicesList.innerHTML = '<div class="empty-state">–£—Å–ª—É–≥ –ø–æ–∫–∞ –Ω–µ—Ç. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é —É—Å–ª—É–≥—É!</div>';
                return;
            }
            
            servicesList.innerHTML = services.map(service => `
                <div class="service-item">
                    <div class="item-header">
                        <div class="service-name">${service.name}</div>
                        <button class="btn-danger" onclick="deleteService('${service.id}')">–£–¥–∞–ª–∏—Ç—å</button>
                    </div>
                    <div class="service-price">${service.price} —Ä—É–±.</div>
                    <div class="service-duration">${service.duration} –º–∏–Ω—É—Ç | ${getCategoryName(service.category)}</div>
                    ${service.description ? `<div class="service-description">${service.description}</div>` : ''}
                </div>
            `).join('');
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        function getCategoryName(category) {
            const categories = {
                'nails': '–ù–æ–≥—Ç–µ–≤–æ–π —Å–µ—Ä–≤–∏—Å',
                'hair': '–ü–∞—Ä–∏–∫–º–∞—Ö–µ—Ä—Å–∫–∏–µ —É—Å–ª—É–≥–∏',
                'cosmetology': '–ö–æ—Å–º–µ—Ç–æ–ª–æ–≥–∏—è',
                'massage': '–ú–∞—Å—Å–∞–∂',
                'other': '–î—Ä—É–≥–æ–µ'
            };
            return categories[category] || '–î—Ä—É–≥–æ–µ';
        }
        
        // –£–¥–∞–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∏
        function deleteService(serviceId) {
            if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É —É—Å–ª—É–≥—É?')) return;
            
            const services = getData(dataStores.services);
            const updatedServices = services.filter(service => service.id !== serviceId);
            saveData(dataStores.services, updatedServices);
            
            tg.showPopup({
                title: '‚úÖ –£—Å–ø–µ—à–Ω–æ!',
                message: '–£—Å–ª—É–≥–∞ —É–¥–∞–ª–µ–Ω–∞',
                buttons: [{ type: 'ok' }]
            });
            
            renderServices();
            updateDashboard();
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ñ–æ—Ä–º—ã —É—Å–ª—É–≥
        document.getElementById('service-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('service-name').value.trim();
            const price = parseInt(document.getElementById('service-price').value);
            const duration = parseInt(document.getElementById('service-duration').value);
            const category = document.getElementById('service-category').value;
            const description = document.getElementById('service-description').value.trim();
            
            if (!name) {
                tg.showPopup({
                    title: '–û—à–∏–±–∫–∞',
                    message: '–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏',
                    buttons: [{ type: 'ok' }]
                });
                return;
            }
            
            const service = {
                id: Date.now().toString(),
                name: name,
                price: price,
                duration: duration,
                category: category,
                description: description,
                createdAt: new Date().toISOString()
            };
            
            const services = getData(dataStores.services);
            services.push(service);
            saveData(dataStores.services, services);
            
            this.reset();
            
            tg.showPopup({
                title: '‚úÖ –£—Å–ø–µ—à–Ω–æ!',
                message: `–£—Å–ª—É–≥–∞ "${service.name}" –¥–æ–±–∞–≤–ª–µ–Ω–∞`,
                buttons: [{ type: 'ok' }]
            });
            
            renderServices();
            updateDashboard();
        });
        
        // ==================== –†–ê–ó–î–ï–õ –ö–õ–ò–ï–ù–¢–û–í ====================
        
        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Å–ø–∏—Å–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤
        function renderClients() {
            const clients = getData(dataStores.clients);
            const clientsList = document.getElementById('clients-list');
            
            if (clients.length === 0) {
                clientsList.innerHTML = '<div class="empty-state">–ö–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞!</div>';
                return;
            }
            
            clientsList.innerHTML = clients.map(client => `
                <div class="client-item">
                    <div class="item-header">
                        <div class="client-name">${client.name}</div>
                        <button class="btn-danger" onclick="deleteClient('${client.id}')">–£–¥–∞–ª–∏—Ç—å</button>
                    </div>
                    <div class="client-phone">üìû ${client.phone}</div>
                    ${client.email ? `<div class="client-email">üìß ${client.email}</div>` : ''}
                    ${client.notes ? `<div class="client-notes">${client.notes}</div>` : ''}
                </div>
            `).join('');
        }
        
        // –£–¥–∞–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞
        function deleteClient(clientId) {
            if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞?')) return;
            
            const clients = getData(dataStores.clients);
            const updatedClients = clients.filter(client => client.id !== clientId);
            saveData(dataStores.clients, updatedClients);
            
            tg.showPopup({
                title: '‚úÖ –£—Å–ø–µ—à–Ω–æ!',
                message: '–ö–ª–∏–µ–Ω—Ç —É–¥–∞–ª–µ–Ω',
                buttons: [{ type: 'ok' }]
            });
            
            renderClients();
            updateDashboard();
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ñ–æ—Ä–º—ã –∫–ª–∏–µ–Ω—Ç–æ–≤
        document.getElementById('client-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('client-name').value.trim();
            const phone = document.getElementById('client-phone').value.trim();
            const email = document.getElementById('client-email').value.trim();
            const notes = document.getElementById('client-notes').value.trim();
            
            if (!name || !phone) {
                tg.showPopup({
                    title: '–û—à–∏–±–∫–∞',
                    message: '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è',
                    buttons: [{ type: 'ok' }]
                });
                return;
            }
            
            const client = {
                id: Date.now().toString(),
                name: name,
                phone: phone,
                email: email,
                notes: notes,
                createdAt: new Date().toISOString()
            };
            
            const clients = getData(dataStores.clients);
            clients.push(client);
            saveData(dataStores.clients, clients);
            
            this.reset();
            
            tg.showPopup({
                title: '‚úÖ –£—Å–ø–µ—à–Ω–æ!',
                message: `–ö–ª–∏–µ–Ω—Ç "${client.name}" –¥–æ–±–∞–≤–ª–µ–Ω`,
                buttons: [{ type: 'ok' }]
            });
            
            renderClients();
            updateDashboard();
        });
        
        // ==================== –†–ê–ó–î–ï–õ –ó–ê–ü–ò–°–ï–ô ====================
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ä–º—ã –∑–∞–ø–∏—Å–∏
        function loadAppointmentForm() {
            const clients = getData(dataStores.clients);
            const services = getData(dataStores.services);
            
            const clientSelect = document.getElementById('appointment-client');
            const serviceSelect = document.getElementById('appointment-service');
            
            // –û—á–∏—â–∞–µ–º –∏ –∑–∞–ø–æ–ª–Ω—è–µ–º –≤—ã–±–æ—Ä –∫–ª–∏–µ–Ω—Ç–∞
            clientSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∏–µ–Ω—Ç–∞</option>';
            clients.forEach(client => {
                clientSelect.innerHTML += `<option value="${client.id}">${client.name} (${client.phone})</option>`;
            });
            
            // –û—á–∏—â–∞–µ–º –∏ –∑–∞–ø–æ–ª–Ω—è–µ–º –≤—ã–±–æ—Ä —É—Å–ª—É–≥–∏
            serviceSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É</option>';
            services.forEach(service => {
                serviceSelect.innerHTML += `<option value="${service.id}">${service.name} - ${service.price} —Ä—É–±.</option>`;
            });
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–µ–≥–æ–¥–Ω—è—à–Ω—é—é –¥–∞—Ç—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            document.getElementById('appointment-date').valueAsDate = new Date();
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        function loadCalendar() {
            // –ü—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è –Ω–∞ 7 –¥–Ω–µ–π
            const calendarDays = document.getElementById('calendar-days');
            calendarDays.innerHTML = '';
            
            const today = new Date();
            for (let i = 0; i < 7; i++) {
                const date = new Date(today);
                date.setDate(today.getDate() + i);
                
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                dayElement.textContent = date.getDate();
                dayElement.onclick = () => selectCalendarDate(date);
                
                if (i === 0) {
                    dayElement.classList.add('selected');
                    selectCalendarDate(date);
                }
                
                calendarDays.appendChild(dayElement);
            }
        }
        
        // –í—ã–±–æ—Ä –¥–∞—Ç—ã –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ
        function selectCalendarDate(date) {
            document.querySelectorAll('.calendar-day').forEach(day => {
                day.classList.remove('selected');
            });
            event.target.classList.add('selected');
            
            loadTimeSlots(date);
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤
        function loadTimeSlots(date) {
            const timeSlots = document.getElementById('time-slots');
            timeSlots.innerHTML = '';
            
            const settings = getData(dataStores.settings, { timeInterval: 30 });
            const interval = settings.timeInterval || 30;
            
            const appointments = getData(dataStores.appointments);
            const dateStr = date.toISOString().split('T')[0];
            const dayAppointments = appointments.filter(apt => apt.date === dateStr);
            
            for (let hour = 9; hour < 21; hour++) {
                for (let minute = 0; minute < 60; minute += interval) {
                    const timeString = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;
                    
                    const slotElement = document.createElement('button');
                    slotElement.className = 'time-slot';
                    slotElement.textContent = timeString;
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–Ω—è—Ç –ª–∏ —Å–ª–æ—Ç
                    const isBooked = dayAppointments.some(apt => apt.time === timeString);
                    if (isBooked) {
                        slotElement.classList.add('booked');
                        slotElement.disabled = true;
                    } else {
                        slotElement.onclick = () => selectTimeSlot(timeString, dateStr);
                    }
                    
                    timeSlots.appendChild(slotElement);
                }
            }
        }
        
        // –í—ã–±–æ—Ä –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Å–ª–æ—Ç–∞
        function selectTimeSlot(time, date) {
            tg.showPopup({
                title: '–í—ã–±–æ—Ä –≤—Ä–µ–º–µ–Ω–∏',
                message: `–í—ã–±—Ä–∞–Ω–æ ${date} –≤ ${time}`,
                buttons: [{ type: 'ok' }]
            });
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –∑–∞–ø–∏—Å–µ–π
        function loadAppointmentsList() {
            const appointments = getData(dataStores.appointments);
            const services = getData(dataStores.services);
            const clients = getData(dataStores.clients);
            
            const appointmentsList = document.getElementById('appointments-list');
            
            if (appointments.length === 0) {
                appointmentsList.innerHTML = '<div class="empty-state">–ó–∞–ø–∏—Å–µ–π –ø–æ–∫–∞ –Ω–µ—Ç</div>';
                return;
            }
            
            appointmentsList.innerHTML = appointments.map(appointment => {
                const client = clients.find(c => c.id === appointment.clientId);
                const service = services.find(s => s.id === appointment.serviceId);
                
                return `
                    <div class="appointment-item">
                        <div class="status-badge status-${appointment.status || 'pending'}">
                            ${appointment.status === 'confirmed' ? '–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞' : 
                              appointment.status === 'completed' ? '–ó–∞–≤–µ—Ä—à–µ–Ω–∞' : '–û–∂–∏–¥–∞–Ω–∏–µ'}
                        </div>
                        <div class="item-header">
                            <div class="client-name">${client ? client.name : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∫–ª–∏–µ–Ω—Ç'}</div>
                            <button class="btn-danger" onclick="deleteAppointment('${appointment.id}')">–£–¥–∞–ª–∏—Ç—å</button>
                        </div>
                        <div class="appointment-details">
                            <div class="appointment-time">${appointment.date} –≤ ${appointment.time}</div>
                            <div>${service ? service.name : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è —É—Å–ª—É–≥–∞'} - ${service ? service.price + ' —Ä—É–±.' : ''}</div>
                            ${appointment.notes ? `<div>üìù ${appointment.notes}</div>` : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        // –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏
        function deleteAppointment(appointmentId) {
            if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –∑–∞–ø–∏—Å—å?')) return;
            
            const appointments = getData(dataStores.appointments);
            const updatedAppointments = appointments.filter(apt => apt.id !== appointmentId);
            saveData(dataStores.appointments, updatedAppointments);
            
            tg.showPopup({
                title: '‚úÖ –£—Å–ø–µ—à–Ω–æ!',
                message: '–ó–∞–ø–∏—Å—å —É–¥–∞–ª–µ–Ω–∞',
                buttons: [{ type: 'ok' }]
            });
            
            loadAppointmentsList();
            updateDashboard();
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ñ–æ—Ä–º—ã –∑–∞–ø–∏—Å–∏
        document.getElementById('appointment-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const clientId = document.getElementById('appointment-client').value;
            const serviceId = document.getElementById('appointment-service').value;
            const date = document.getElementById('appointment-date').value;
            const time = document.getElementById('appointment-time').value;
            const notes = document.getElementById('appointment-notes').value.trim();
            
            if (!clientId || !serviceId || !date || !time) {
                tg.showPopup({
                    title: '–û—à–∏–±–∫–∞',
                    message: '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è',
                    buttons: [{ type: 'ok' }]
                });
                return;
            }
            
            const appointment = {
                id: Date.now().toString(),
                clientId: clientId,
                serviceId: serviceId,
                date: date,
                time: time,
                notes: notes,
                status: 'pending',
                createdAt: new Date().toISOString()
            };
            
            const appointments = getData(dataStores.appointments);
            appointments.push(appointment);
            saveData(dataStores.appointments, appointments);
            
            this.reset();
            loadAppointmentForm();
            
            tg.showPopup({
                title: '‚úÖ –£—Å–ø–µ—à–Ω–æ!',
                message: '–ó–∞–ø–∏—Å—å —Å–æ–∑–¥–∞–Ω–∞',
                buttons: [{ type: 'ok' }]
            });
            
            updateDashboard();
        });
        
        // ==================== –†–ê–ó–î–ï–õ –û–¢–ß–ï–¢–û–í ====================
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞
        function generateReport() {
            const services = getData(dataStores.services);
            const clients = getData(dataStores.clients);
            const appointments = getData(dataStores.appointments);
            
            // –û–±—â–∏–π –¥–æ—Ö–æ–¥
            const totalRevenue = appointments.reduce((sum, apt) => {
                const service = services.find(s => s.id === apt.serviceId);
                return sum + (service ? service.price : 0);
            }, 0);
            
            // –°—Ä–µ–¥–Ω–∏–π —á–µ–∫
            const avgReceipt = appointments.length > 0 ? Math.round(totalRevenue / appointments.length) : 0;
            
            // –°–∞–º–∞—è –ø–æ–ø—É–ª—è—Ä–Ω–∞—è —É—Å–ª—É–≥–∞
            const serviceCounts = {};
            appointments.forEach(apt => {
                serviceCounts[apt.serviceId] = (serviceCounts[apt.serviceId] || 0) + 1;
            });
            
            let popularService = '-';
            let maxCount = 0;
            Object.keys(serviceCounts).forEach(serviceId => {
                if (serviceCounts[serviceId] > maxCount) {
                    maxCount = serviceCounts[serviceId];
                    const service = services.find(s => s.id === serviceId);
                    popularService = service ? service.name : '-';
                }
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç—á–µ—Ç
            document.getElementById('report-total-revenue').textContent = totalRevenue;
            document.getElementById('report-total-appointments').textContent = appointments.length;
            document.getElementById('report-avg-receipt').textContent = avgReceipt;
            document.getElementById('report-popular-service').textContent = popularService;
            
            tg.showPopup({
                title: 'üìä –û—Ç—á–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω',
                message: `–û–±—â–∏–π –¥–æ—Ö–æ–¥: ${totalRevenue} —Ä—É–±.\n–í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π: ${appointments.length}\n–°—Ä–µ–¥–Ω–∏–π —á–µ–∫: ${avgReceipt} —Ä—É–±.`,
                buttons: [{ type: 'ok' }]
            });
        }
        
        // –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
        function exportData() {
            const data = {
                services: getData(dataStores.services),
                clients: getData(dataStores.clients),
                appointments: getData(dataStores.appointments),
                settings: getData(dataStores.settings),
                exportedAt: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `salonhelper-backup-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            tg.showPopup({
                title: '‚úÖ –î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã',
                message: '–†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ —Ñ–∞–π–ª',
                buttons: [{ type: 'ok' }]
            });
        }
        
        // ==================== –†–ê–ó–î–ï–õ –ù–ê–°–¢–†–û–ï–ö ====================
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫
        function loadSettings() {
            const settings = getData(dataStores.settings, {});
            
            document.getElementById('business-name').value = settings.businessName || '';
            document.getElementById('business-phone').value = settings.businessPhone || '';
            document.getElementById('work-hours').value = settings.workHours || '';
            document.getElementById('time-interval').value = settings.timeInterval || 30;
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
        function saveSettings() {
            const settings = {
                businessName: document.getElementById('business-name').value.trim(),
                businessPhone: document.getElementById('business-phone').value.trim(),
                workHours: document.getElementById('work-hours').value.trim(),
                timeInterval: parseInt(document.getElementById('time-interval').value) || 30,
                updatedAt: new Date().toISOString()
            };
            
            saveData(dataStores.settings, settings);
            
            tg.showPopup({
                title: '‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã',
                message: '–ò–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã',
                buttons: [{ type: 'ok' }]
            });
            
            updateDashboard();
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        function loadSampleData() {
            if (!confirm('–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ? –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã.')) return;
            
            const sampleServices = [
                { id: '1', name: '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –º–∞–Ω–∏–∫—é—Ä', price: 1200, duration: 60, category: 'nails', description: '–ú–∞–Ω–∏–∫—é—Ä —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º –≥–µ–ª—å-–ª–∞–∫–æ–º' },
                { id: '2', name: '–ü–µ–¥–∏–∫—é—Ä –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π', price: 1800, duration: 90, category: 'nails', description: '–ü–µ–¥–∏–∫—é—Ä —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —Å—Ç–æ–ø' },
                { id: '3', name: '–ñ–µ–Ω—Å–∫–∞—è —Å—Ç—Ä–∏–∂–∫–∞', price: 1500, duration: 60, category: 'hair', description: '–°—Ç—Ä–∏–∂–∫–∞ —Å —É–∫–ª–∞–¥–∫–æ–π' },
                { id: '4', name: '–ú—É–∂—Å–∫–∞—è —Å—Ç—Ä–∏–∂–∫–∞', price: 800, duration: 30, category: 'hair', description: '–°—Ç—Ä–∏–∂–∫–∞ –º–∞—à–∏–Ω–∫–æ–π –∏ –Ω–æ–∂–Ω–∏—Ü–∞–º–∏' },
                { id: '5', name: '–ß–∏—Å—Ç–∫–∞ –ª–∏—Ü–∞', price: 2200, duration: 60, category: 'cosmetology', description: '–ê–ø–ø–∞—Ä–∞—Ç–Ω–∞—è —á–∏—Å—Ç–∫–∞ –ª–∏—Ü–∞' }
            ];
            
            const sampleClients = [
                { id: '1', name: '–ê–Ω–Ω–∞ –ò–≤–∞–Ω–æ–≤–∞', phone: '+7 912 345 67 89', email: 'anna@example.com', notes: '–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç' },
                { id: '2', name: '–ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞', phone: '+7 923 456 78 90', email: '', notes: '–ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç –≤–µ—á–µ—Ä–Ω–∏–µ –∑–∞–ø–∏—Å–∏' },
                { id: '3', name: '–ï–ª–µ–Ω–∞ –°–∏–¥–æ—Ä–æ–≤–∞', phone: '+7 934 567 89 01', email: 'elena@example.com', notes: '' }
            ];
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º
            const currentServices = getData(dataStores.services);
            const currentClients = getData(dataStores.clients);
            
            saveData(dataStores.services, [...currentServices, ...sampleServices]);
            saveData(dataStores.clients, [...currentClients, ...sampleClients]);
            
            tg.showPopup({
                title: '‚úÖ –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã',
                message: '–î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–∏–º–µ—Ä—ã —É—Å–ª—É–≥ –∏ –∫–ª–∏–µ–Ω—Ç–æ–≤',
                buttons: [{ type: 'ok' }]
            });
            
            renderServices();
            renderClients();
            updateDashboard();
        }
        
        // –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
        function clearAllData() {
            if (!confirm('–í–ù–ò–ú–ê–ù–ò–ï! –≠—Ç–æ —É–¥–∞–ª–∏—Ç –í–°–ï –¥–∞–Ω–Ω—ã–µ. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?')) return;
            
            localStorage.clear();
            
            tg.showPopup({
                title: '‚úÖ –î–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã',
                message: '–í—Å–µ –¥–∞–Ω–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã',
                buttons: [{ type: 'ok' }]
            });
            
            renderServices();
            renderClients();
            loadAppointmentsList();
            updateDashboard();
        }
        
        // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø ====================
        document.addEventListener('DOMContentLoaded', function() {
            console.log('SalonHelper –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            loadSettings();
            renderServices();
            renderClients();
            loadAppointmentForm();
            updateDashboard();
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
            setTimeout(() => {
                const container = document.querySelector('.container');
                container.style.transition = 'all 0.5s ease';
                container.style.opacity = '1';
                container.style.transform = 'translateY(0)';
            }, 100);
            
            console.log('SalonHelper –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ');
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –æ—à–∏–±–æ–∫
        window.addEventListener('error', function(e) {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:', e.error);
        });
    </script>
</body>
</html>